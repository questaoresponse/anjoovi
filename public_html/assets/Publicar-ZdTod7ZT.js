var he=Object.defineProperty;var ce=t=>{throw TypeError(t)};var ve=(t,e,i)=>e in t?he(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var j=(t,e,i)=>ve(t,typeof e!="symbol"?e+"":e,i),de=(t,e,i)=>e.has(t)||ce("Cannot "+i);var n=(t,e,i)=>(de(t,e,"read from private field"),i?i.call(t):e.get(t)),F=(t,e,i)=>e.has(t)?ce("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i),te=(t,e,i,r)=>(de(t,e,"write to private field"),r?r.call(t,i):e.set(t,i),i);import{R as ue,u as me,a as fe,r as d,s as V,j as a,b as we,L as z}from"./index-C9DNQLca.js";/* empty css             */var f;(function(t){t.LOAD="LOAD",t.EXEC="EXEC",t.WRITE_FILE="WRITE_FILE",t.READ_FILE="READ_FILE",t.DELETE_FILE="DELETE_FILE",t.RENAME="RENAME",t.CREATE_DIR="CREATE_DIR",t.LIST_DIR="LIST_DIR",t.DELETE_DIR="DELETE_DIR",t.ERROR="ERROR",t.DOWNLOAD="DOWNLOAD",t.PROGRESS="PROGRESS",t.LOG="LOG"})(f||(f={}));const _e=(()=>{let t=0;return()=>t++})(),Re=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),ye=new Error("called FFmpeg.terminate()");var E,P,T,H,J,se,x;class pe{constructor(){F(this,E,null);F(this,P,{});F(this,T,{});F(this,H,[]);F(this,J,[]);j(this,"loaded",!1);F(this,se,()=>{n(this,E)&&(n(this,E).onmessage=({data:{id:e,type:i,data:r}})=>{switch(i){case f.LOAD:this.loaded=!0,n(this,P)[e](r);break;case f.EXEC:case f.WRITE_FILE:case f.READ_FILE:case f.DELETE_FILE:case f.RENAME:case f.CREATE_DIR:case f.LIST_DIR:case f.DELETE_DIR:n(this,P)[e](r);break;case f.LOG:n(this,H).forEach(l=>l(r));break;case f.PROGRESS:n(this,J).forEach(l=>l(r));break;case f.ERROR:n(this,T)[e](r);break}delete n(this,P)[e],delete n(this,T)[e]})});F(this,x,({type:e,data:i},r=[])=>n(this,E)?new Promise((l,m)=>{const o=_e();n(this,E)&&n(this,E).postMessage({id:o,type:e,data:i},r),n(this,P)[o]=l,n(this,T)[o]=m}):Promise.reject(Re));j(this,"load",(e={})=>(n(this,E)||(te(this,E,new Worker(new URL("/assets/worker-RjqUVU6j.js",import.meta.url),{type:"module"})),n(this,se).call(this)),n(this,x).call(this,{type:f.LOAD,data:e})));j(this,"exec",(e,i=-1)=>n(this,x).call(this,{type:f.EXEC,data:{args:e,timeout:i}}));j(this,"terminate",()=>{const e=Object.keys(n(this,T));for(const i of e)n(this,T)[i](ye),delete n(this,T)[i],delete n(this,P)[i];n(this,E)&&(n(this,E).terminate(),te(this,E,null),this.loaded=!1)});j(this,"writeFile",(e,i)=>{const r=[];return i instanceof Uint8Array&&r.push(i.buffer),n(this,x).call(this,{type:f.WRITE_FILE,data:{path:e,data:i}},r)});j(this,"readFile",(e,i="binary")=>n(this,x).call(this,{type:f.READ_FILE,data:{path:e,encoding:i}}));j(this,"deleteFile",e=>n(this,x).call(this,{type:f.DELETE_FILE,data:{path:e}}));j(this,"rename",(e,i)=>n(this,x).call(this,{type:f.RENAME,data:{oldPath:e,newPath:i}}));j(this,"createDir",e=>n(this,x).call(this,{type:f.CREATE_DIR,data:{path:e}}));j(this,"listDir",e=>n(this,x).call(this,{type:f.LIST_DIR,data:{path:e}}));j(this,"deleteDir",e=>n(this,x).call(this,{type:f.DELETE_DIR,data:{path:e}}))}on(e,i){e==="log"?n(this,H).push(i):e==="progress"&&n(this,J).push(i)}off(e,i){e==="log"?te(this,H,n(this,H).filter(r=>r!==i)):e==="progress"&&te(this,J,n(this,J).filter(r=>r!==i))}}E=new WeakMap,P=new WeakMap,T=new WeakMap,H=new WeakMap,J=new WeakMap,se=new WeakMap,x=new WeakMap;const Ee=new Error("failed to get response body reader"),je=new Error("failed to complete download"),xe="Content-Length",be=t=>new Promise((e,i)=>{const r=new FileReader;r.onload=()=>{const{result:l}=r;l instanceof ArrayBuffer?e(new Uint8Array(l)):e(new Uint8Array)},r.onerror=l=>{var m,o;i(Error(`File could not be read! Code=${((o=(m=l==null?void 0:l.target)==null?void 0:m.error)==null?void 0:o.code)||-1}`))},r.readAsArrayBuffer(t)}),le=async t=>{let e;if(typeof t=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(t)?e=atob(t.split(",")[1]).split("").map(i=>i.charCodeAt(0)):e=await(await fetch(t)).arrayBuffer();else if(t instanceof URL)e=await(await fetch(t)).arrayBuffer();else if(t instanceof File||t instanceof Blob)e=await be(t);else return new Uint8Array;return new Uint8Array(e)},Ie=async(t,e)=>{var l;const i=await fetch(t);let r;try{const m=parseInt(i.headers.get(xe)||"-1"),o=(l=i.body)==null?void 0:l.getReader();if(!o)throw Ee;const W=[];let D=0;for(;;){const{done:b,value:B}=await o.read(),k=B?B.length:0;if(b){if(m!=-1&&m!==D)throw je;e&&e({url:t,total:m,received:D,delta:k,done:b});break}W.push(B),D+=k,e&&e({url:t,total:m,received:D,delta:k,done:b})}const q=new Uint8Array(D);let M=0;for(const b of W)q.set(b,M),M+=b.length;r=q.buffer}catch(m){console.log("failed to send download progress event: ",m),r=await i.arrayBuffer()}return r},Y=async(t,e,i=!1,r)=>{const l=i?await Ie(t,r):await(await fetch(t)).arrayBuffer(),m=new Blob([l],{type:e});return URL.createObjectURL(m)};function Le(){const t=me(),e=t.server,i=fe(),r={titulo:d.useRef(null),file:d.useRef(null),original_format:d.useRef(null),imagem_view:d.useRef(null),image_element:d.useRef(null)},[l,m]=d.useState({type:"jpeg",name:"Upload",src:V}),[o,W]=d.useState(!1),[D,q]=d.useState(!1),[M,b]=d.useState(!1),[B,k]=d.useState(0),I=d.useRef(new pe),U=p=>{const u=p.target.files[0];if(u){const L=new FileReader;L.onloadend=async()=>{const A=L.result instanceof ArrayBuffer?L.result:new ArrayBuffer(0),S=new Uint8Array(A),O=String.fromCharCode(...S.slice(4,8)),Q=["isom","iso2","mp41","mp42","avc1","iso5"];let N=null;if(O==="ftyp"&&Q.includes(String.fromCharCode(...S.slice(8,12))))N="mp4";else{const y={jpeg:[255,216,255],png:[137,80,78,71,13,10,26,10],gif:[71,73,70]};for(const[ee,$]of Object.entries(y))if($.every((oe,c)=>oe===S[c])){N=ee;break}}if(N&&["mp4","jpeg"].includes(N))if(N=="mp4"){I.current.writeFile(u.name,await le(u));const y="output."+u.name.split(".").slice(-1);I.current.writeFile(y,await le(u)),I.current.exec(["-i",u.name,"-t","00:00:15","-c","copy",y]);const ee=new Uint8Array(await I.current.readFile(y));await I.current.deleteFile(u.name),await I.current.deleteFile(y);const $=new Blob([ee.buffer],{type:"video/"+u.name.split(".").slice(-1)}),X=URL.createObjectURL($);m({type:N,name:u.name,file:$,src:X})}else{const y=new FileReader;y.onloadend=()=>{typeof y.result=="string"?m({type:N,name:u.name,file:u,src:y.result}):m({type:"jpeg",name:"Upload",src:V})},y.readAsDataURL(u)}else m({type:"jpeg",name:"Upload",src:V}),p.target.value="",ae()},L.readAsArrayBuffer(u)}},Z=p=>{const u=Math.round(p.loaded*100/p.total)==100?99:Math.round(p.loaded*100/p.total);b(!0),k(u)},K=async p=>{p.preventDefault();var u=new FormData,L=r.titulo.current.value,A=l.file,S=JSON.parse(r.original_format.current.value);L!=""&&u.append("titulo",L),A&&u.append("file",A),S&&u.append("original_format",S.toString()),u.append("type","option"),u.append("typeMime",l.type);var O=await i.post(e+"/admin/24_cadastro",u,{arquivo:!0,porcentagem:Z});if(O.error)t.setRedirectError(O.error);else if(O.data.result=="true"){b(!1),k(0),W(!0);var Q=setTimeout(()=>{W(!1),clearTimeout(Q)},2e3);r.titulo.current.value="",r.file.current.value="",r.original_format.current.value="true",m({type:"jpeg",name:"Upload",src:V}),ie()}},ae=()=>{q(!0);const p=setTimeout(()=>{q(!1),clearTimeout(p)},2e3)};d.useEffect(()=>{t.setSelected("publicar"),(async()=>{const p="https://unpkg.com/@ffmpeg/core-mt@0.12.6/dist/esm";I.current.on("log",({message:u})=>{console.log(u)}),await I.current.load({coreURL:await Y(`${p}/ffmpeg-core.js`,"text/javascript"),wasmURL:await Y(`${p}/ffmpeg-core.wasm`,"application/wasm"),workerURL:await Y(`${p}/ffmpeg-core.worker.js`,"text/javascript")}),console.log("carregado")})()},[]);const ie=()=>{const p=["rd","of"],u=JSON.parse(r.original_format.current.value);r.image_element.current.classList.replace(p[+!u],p[+u])};return a.jsx("div",{id:"pg",className:"c24",children:a.jsxs("div",{id:"dt",className:"fechado",children:[a.jsx(ge,{}),a.jsx("div",{id:"msg1",children:"Cadastrar 24 horas"}),a.jsxs("form",{onSubmit:K,children:[a.jsx("label",{children:"Título"}),a.jsx("input",{ref:r.titulo,className:"input",id:"titulo",placeholder:"Insira um título"}),a.jsx("label",{children:"Capa"}),a.jsxs("div",{id:"imagem-div",children:[a.jsxs("div",{ref:r.imagem_view,id:"imagem-view",className:"col-12 col-md-6",children:[l.type=="mp4"?a.jsx("video",{ref:r.image_element,controls:!0,className:"of",src:l.src}):a.jsx("img",{ref:r.image_element,className:"of",src:l.src}),";"]}),a.jsx("input",{className:"file",ref:r.file,onChange:U,type:"file",accept:"image/jpg, image/jpeg, video/mp4",required:!0}),a.jsxs("div",{id:"imagem-pt",children:[a.jsx("div",{id:"imagem",onClick:()=>{r.file.current.click()},children:a.jsx("div",{className:"txt-1",children:l.name})}),a.jsxs("select",{defaultValue:"true",onChange:ie,ref:r.original_format,id:"original_format",children:[a.jsx("option",{value:"true",children:"Formato original"}),a.jsx("option",{value:"false",children:"Redimensionar"})]})]})]}),a.jsx("button",{type:"submit",id:"button",children:"Enviar"})]}),a.jsx("div",{id:"uploadd",style:{display:M?"flex":"none"},children:a.jsx("div",{id:"uploadbd",children:a.jsxs("div",{id:"porcentagem",children:["Enviando:",B,"%"]})})}),a.jsx("div",{id:"m",style:{display:o?"flex":"none"},children:"24 horas cadastrado com sucesso."}),a.jsx("div",{id:"errorImage",style:{display:D?"flex":"none"},children:"O tipo do arquivo não corresponde a jpg/jpeg ou mp4. Selecione um arquivo válido."})]})})}const Ae=ue.memo(Le),Ne=Object.freeze(Object.defineProperty({__proto__:null,default:Ae},Symbol.toStringTag,{value:"Module"}));function Se(){const t=me(),{server:e,navigate:i}=t,r=fe(),l=d.useRef(!1),m=d.useRef(),o={titulo:d.useRef(null),original_format:d.useRef(null),video_input:d.useRef(null),video_view:d.useRef(null),file:d.useRef(null),imagem_view:d.useRef(null),image_element:d.useRef(null)},[W,D]=d.useState("Upload"),[q,M]=d.useState("Upload"),[b,B]=d.useState(!1),[k,I]=d.useState(!1),[U,Z]=d.useState({name:"",type:"jpeg",src:V,width:"100%",height:"100%"}),[K,ae]=d.useState({src:V,width:"100%",height:"100%"}),[ie,p]=d.useState(!1),[u,L]=d.useState(0),A=d.useRef(new pe),S=(c=void 0,s,v,G,C)=>{if(typeof v=="string")if(C=="mp4"){const w=document.createElement("video");w.onloadedmetadata=()=>{const R=o.video_view.current.offsetWidth,h=o.video_view.current.offsetHeight;var g=w.videoWidth,_=w.videoHeight;R/g*_>h?(g=h/_*g,_=h):(_=h,g=R),Z({type:"mp4",file:c,name:s,src:v,width:g,height:_})},w.src=v}else{const w=new Image;w.onload=()=>{const R=o.imagem_view.current.offsetWidth,h=o.imagem_view.current.offsetHeight;var g=w.width,_=w.height;R/g*_>h?(g=h/_*g,_=h):(_=R/g*_,g=R),G?Z({type:"mp4",file:c,name:s,src:v,width:g,height:_}):ae({src:v,width:g,height:_})},w.src=v}},O=(c,s)=>{c&&Z({type:"jpeg",name:"",src:V,width:"100%",height:"100%"}),s&&ae({src:V,width:"100%",height:"100%"})},Q=c=>{const s=c.target.files[0];if(s){const v=new FileReader;v.onloadend=()=>{const G=v.result instanceof ArrayBuffer?v.result:new ArrayBuffer(0),C=new Uint8Array(G);let w=null;const R={jpeg:[255,216,255],png:[137,80,78,71,13,10,26,10],gif:[71,73,70]};for(const[h,g]of Object.entries(R))if(g.every((re,ne)=>re===C[ne])){w=h;break}if(w=="jpeg"){M(s.name);const h=new FileReader;h.onloadend=()=>{S(s,s.name,h.result,!1,w)},h.readAsDataURL(s)}else O(!1,!0),c.target.value="",$()},v.readAsArrayBuffer(s)}},N=c=>{const s=c.target.files[0];if(s){const v=new FileReader;v.onloadend=async()=>{const G=v.result instanceof ArrayBuffer?v.result:new ArrayBuffer(0),C=new Uint8Array(G),w=String.fromCharCode(...C.slice(4,8)),R=["isom","iso2","mp41","mp42","avc1","iso5"];let h=null;if(w==="ftyp"&&R.includes(String.fromCharCode(...C.slice(8,12)))){A.current.writeFile(s.name,await le(s));const g="output."+s.name.split(".").slice(-1);A.current.exec(["-i",s.name,"-t","00:01:00","-c","copy",g]);const _=new Uint8Array(await A.current.readFile(g));await A.current.deleteFile(s.name),await A.current.deleteFile(g);const re=new Blob([_.buffer],{type:"audio/"+s.name.split(".").slice(-1)}),ne=URL.createObjectURL(re);h="mp4",D(s.name),S(re,s.name,ne,!0,h)}else O(!0,!1),c.target.value="",$()},v.readAsArrayBuffer(s)}},y=c=>{const s=Math.round(c.loaded*100/c.total)==100?99:Math.round(c.loaded*100/c.total);p(!0),L(s)},ee=async c=>{c.preventDefault();var s=new FormData;const v=o.titulo.current.value,G=U.file,C=o.file.current.files[0],w=JSON.parse(o.original_format.current.value);s.append("type","option"),l.current&&s.append("id",m.current.id.toString()),C&&s.append("imagem",C),C&&s.append("imagens_edit","true"),s.append("titulo",v),l.current||(s.append("video",G,U.name),p(!0)),w&&s.append("original_format",w.toString());var R=await r.post(e+"/admin/videos_cadastro?type="+(l.current?"edit":"cadastro"),s,l.current?{arquivo:!0}:{arquivo:!0,porcentagem:y});if(R.error)t.setRedirectError(R.error);else if(R.data.result=="true"){if(l.current){const g=new URLSearchParams(location.search);if(g.has("origin"))i(decodeURIComponent(g.get("origin")));else{const _=location.pathname.split("_");i(_[0]+"_lista")}l.current=!1,m.current=void 0}p(!1),L(0),B(!0);var h=setTimeout(()=>{B(!1),clearTimeout(h)},2e3);o.titulo.current.value="",o.file.current.value="",o.original_format.current.value="true",M("Upload"),D("Upload"),O(!0,!0)}},$=()=>{I(!0);const c=setTimeout(()=>{I(!1),clearTimeout(c)},2e3)},X=()=>{const c=o.titulo.current.getBoundingClientRect().width;o.video_view.current.style.height=c/1280*720+"px",t.mobile?o.imagem_view.current.style.height=c/720*1280+"px":o.imagem_view.current.style.height=window.innerHeight*.3+"px"};l.current=location.pathname=="/admin/videos_edit",d.useEffect(()=>(X(),t.setSelected("publicar"),document.addEventListener("resize",X),l.current&&r.post(e+"/admin/videos_edit"+location.search,{type:"info"}).then(c=>{if(c.data.result=="true"){o.file.current.required=!1;const s=c.data.post_edit[0];m.current=s,o.titulo.current.value=s.titulo,S(void 0,s.video.split("_").slice(4).join("_"),e+"/videos/"+encodeURIComponent(s.video),!0,"mp4"),s.imagem&&S(void 0,s.imagem.split("_").slice(4).join("_"),e+"/images/"+encodeURIComponent(s.imagem),!1,"jpeg")}}),(async()=>{const c=window.location.href.split("/")[0];await A.current.load({coreURL:await Y(`${c}/ffmpeg-core.js`,"text/javascript"),wasmURL:await Y(`${c}/ffmpeg-core.wasm`,"application/wasm"),workerURL:await Y(`${c}/ffmpeg-core.worker.js`,"text/javascript")}),console.log("carregado")})(),()=>{document.removeEventListener("resize",X)}),[]);const oe=()=>{const c=["rd","of"],s=JSON.parse(o.original_format.current.value);o.image_element.current.classList.replace(c[+!s],c[+s])};return a.jsx("div",{id:"pg",className:"vc",children:a.jsxs("div",{id:"dt",className:"fechado",children:[a.jsx(ge,{}),a.jsx("div",{id:"msg1",children:"Cadastrar vídeo"}),a.jsxs("form",{onSubmit:ee,children:[a.jsx("label",{children:"Título"}),a.jsx("textarea",{ref:o.titulo,className:"input",id:"titulo"}),a.jsx("label",{children:"Video"}),a.jsxs("div",{id:"video-div",children:[a.jsx("div",{ref:o.video_view,id:"video-view",children:U.type=="mp4"?a.jsx("video",{style:{width:"100%",height:"100%"},src:U.src,controls:!0}):a.jsx("img",{style:{width:U.width,height:U.height},src:U.src})}),a.jsx("input",{className:"file",ref:o.video_input,type:"file",accept:"video/mp4",onChange:N}),a.jsx("div",{id:"video-filename",onClick:()=>o.video_input.current.click(),children:W})]}),a.jsx("label",{children:"Capa"}),a.jsxs("div",{id:"imagem-div",children:[a.jsx("div",{ref:o.imagem_view,id:"imagem-view",className:"col-12 col-md-6",children:a.jsx("img",{ref:o.image_element,style:{width:K.width,height:K.height},src:K.src})}),a.jsx("input",{className:"file",ref:o.file,onChange:Q,type:"file",accept:"image/jpg, image/jpeg"}),a.jsxs("div",{id:"imagem-pt",children:[a.jsx("div",{id:"imagem",onClick:()=>{o.file.current.click()},children:a.jsx("div",{className:"txt-1",children:q})}),a.jsxs("select",{defaultValue:"true",onChange:oe,ref:o.original_format,id:"original_format",children:[a.jsx("option",{value:"true",children:"Formato original"}),a.jsx("option",{value:"false",children:"Redimensionar"})]})]})]}),a.jsx("button",{type:"submit",id:"button",children:"Enviar"})]}),a.jsx("div",{id:"uploadd",style:{display:ie?"flex":"none"},children:a.jsx("div",{id:"uploadbd",children:a.jsxs("div",{id:"porcentagem",children:["Enviando:",u,"%"]})})}),a.jsx("div",{id:"m",style:{display:b?"flex":"none"},children:l.current?"Video alterado com sucesso.":"Video cadastrado com sucesso."}),a.jsx("div",{id:"errorImage",style:{display:k?"flex":"none"},children:"O tipo do arquivo não corresponde a jpg/jpeg ou mp4. Selecione um arquivo válido."})]})})}const De=ue.memo(Se),Te=Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"}));function ge(){const t={selected:d.useRef(null)},e=we();var i={"/admin/noticias_cadastro":"1","/admin/24_cadastro":"2","/admin/imagens_cadastro":"3","/admin/musicas_cadastro":"4","/admin/textos_cadastro":"5","/admin/videos_cadastro":"6","/admin/playlists_cadastro":"7"};return d.useEffect(()=>{t.selected.current.className="menu-s selected"+i[e.pathname]},[e.pathname]),a.jsxs("div",{className:"menu",children:[a.jsx("div",{ref:t.selected,className:"menu-s"}),a.jsxs("div",{className:"menu-b",children:[a.jsx(z,{to:"/admin/noticias_cadastro",className:"i-menu2 t1",id:"noticias_cadastro",children:"Matéria"}),a.jsx(z,{to:"/admin/24_cadastro",className:"i-menu2 t2",id:"cadastro_24",children:"24 hora"}),a.jsx(z,{to:"/admin/imagens_cadastro",className:"i-menu2 t3",id:"imagens_cadastro",children:"Imagem"}),a.jsx(z,{to:"/admin/musicas_cadastro",className:"i-menu2 t4",id:"musicas_cadastro",children:"Música"}),a.jsx(z,{to:"/admin/textos_cadastro",className:"i-menu2 t5",id:"textos_cadastro",children:"Texto"}),a.jsx(z,{to:"/admin/videos_cadastro",className:"i-menu2 t6",id:"videos_cadastro",children:"Vídeo"}),a.jsx(z,{to:"/admin/playlists_cadastro",className:"i-menu2 t7",id:"playlists_cadastro",children:"Playlist"})]})]})}export{pe as F,ge as P,Te as V,Ne as _,le as f,Y as t};
