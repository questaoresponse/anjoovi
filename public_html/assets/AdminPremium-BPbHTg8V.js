import{u as P,r as s,a as R,j as e,d as T,l as N}from"./index-DI_uHP_o.js";const E=()=>{const{server:p,setSelected:y,cargo:a}=P(),[t,F]=s.useState((a.current.cargo||0)+8>>3),m=i=>{F((i||0)+8>>3)};s.useEffect(()=>(a.current.addListener(m),x.post(p+"/admin/cargo",{type:"info"}).then(i=>{a.current.setCargo(i.data.cargo)}),()=>{a.current.removeListener(m)}),[]);const x=R(),[L,l]=s.useState(!0),[g,h]=s.useState(null),[k,c]=s.useState(!1),[d,r]=s.useState({isFile:!1,filename:""}),n={input:s.useRef(null)},C=()=>{const i=n.input.current.files[0];if(i){l(!0);const j=new FileReader;j.onload=function(I){const u=I.target.result;typeof u=="string"&&u.length<300?x.post(p+"/admin/premium",{type:"active_license",license:u}).then(f=>{f.data.result=="true"&&(l(!1),f.data.active_license=="true"?(h(!0),a.current.setCargo(f.data.cargo),r({isFile:!1,filename:""}),c(!1),n.input.current.files=new FileList):c(!0))}):(l(!1),c(!0))},j.readAsText(i)}},b=i=>{i.preventDefault(),i.dataTransfer.files&&i.dataTransfer.files.length>0?(n.input.current.files=i.dataTransfer.files,r({isFile:!0,filename:i.dataTransfer.files[0].name})):r({isFile:!1,filename:""})},S=i=>{r({isFile:i.target.files.length>0,filename:i.target.files.length>0?i.target.files[0].name:""})},A=()=>{r({isFile:!1,filename:""}),n.input.current.files=new FileList};s.useEffect(()=>{t!==null&&(l(!1),h(t>1))},[t]),s.useEffect(()=>{y("premium")},[]);const v={1:{name:"START",price:"7,00",expiry:"30"},2:{name:"PRO",price:"12,00",expiry:"60"},3:{name:"PLUS",price:"17,00",expiry:"90"},4:{name:"ULTRA",price:"26,00",expiry:"360"}},o=String(t)in v?v[String(t)]:{name:"",price:"",expiry:""};return e.jsxs("div",{id:"admin-premium",children:[e.jsxs("div",{id:"blocks",children:[e.jsxs("div",{className:"block",children:[e.jsx("div",{className:"msg",children:"Plano atual:"}),g==!0?e.jsxs("div",{id:"block-plan",children:[e.jsxs("div",{className:"title",children:["PREMIUM ",o.name]}),e.jsxs("div",{className:"price",children:["R$ ",o.price]}),e.jsxs("div",{className:"description",children:[e.jsx("p",{children:"Preço/Único"}),e.jsx("p",{children:"Acesso a conteúdo sem publicidade."}),e.jsxs("p",{children:["Duração de ",o.expiry," dias após a compra da licença."]})]}),e.jsx("div",{className:"buyBtn",children:"Assinado"})]}):g==!1?e.jsx("div",{children:e.jsxs("div",{id:"msg-not-plan",children:["Você não possui nenhum plano. ",e.jsx(T,{to:"/premium",children:"Fazer upgrade."})]})}):e.jsx(e.Fragment,{})]}),e.jsxs("div",{className:"block",children:[e.jsx("input",{style:{display:"none"},ref:n.input,type:"file",onChange:S}),e.jsx("div",{id:"input",onClick:()=>n.input.current.click(),onDragOver:i=>i.preventDefault(),onDrop:b,children:d.isFile?d.filename:"Arraste sua licença aqui ou selecione sua licença"}),e.jsx("div",{id:"verify"}),e.jsxs("div",{id:"div-btn",children:[e.jsx("div",{id:"invalid-license",style:{display:k?"block":"none"},children:"Licença inválida."}),e.jsx("div",{id:"cancelBtn",onClick:A,children:"Cancelar"}),e.jsx("div",{id:"verifyBtn",onClick:C,style:{opacity:d.isFile?"1":"0.5"},children:"Verificar licença"})]})]})]}),e.jsx("div",{id:"loading",style:{display:L?"block":"none"},children:e.jsx("img",{src:N})})]})};export{E as default};
