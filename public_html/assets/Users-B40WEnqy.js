import{r as s,j as e,d as q,e as O,u as T,a as X,L as z,X as A}from"./index-DN37LFps.js";const P=s.createContext(void 0),F=(t,n)=>{switch(n.type){case"menu":return{...t,menu:n.value};case"all":return{menu:n.menu,checked:n.checked,element:n.element};case"reset":return{menu:!1,checked:!1,element:!1}}},G=({children:t})=>{const[n,x]=s.useReducer(F,{menu:!1,checked:!1,element:!1,usuarioCallback:!1}),u=s.useRef();return e.jsx(P.Provider,{value:{namePrivate:u,stateReducer:n,setStateReducer:x},children:t})},L=()=>s.useContext(P),H=s.memo(()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"num",children:"N°"}),e.jsx("div",{className:"usuario",children:"USUÁRIO"}),e.jsx("div",{className:"opcoes",children:"OPÇÕES"})]})),_=s.memo(t=>{const{stateReducer:n,setStateReducer:x,namePrivate:u}=L(),h=t.globals.server,i=t.auth,r=t.post,f=t.n,y=t.openExclusion,j=t.recriar,N=c=>{n.usuarioCallback||(c.preventDefault(),u.current=c.target.dataset.anjooviUser),x({type:"all",menu:!0,checked:c.target.checked,element:c.target})},g=()=>{y({usuario:r.usuario,server:h,auth:i,recriar:j})};return e.jsxs("div",{className:"linha",children:[e.jsx("div",{className:"num",children:f}),e.jsx(q,{className:"usuario txt-1",onClick:c=>{c.preventDefault(),window.open("/@"+r.usuario)},to:"/@"+r.usuario,children:r.usuario}),e.jsx("div",{className:"opcoes",children:e.jsxs("div",{className:"opcoesb",children:[e.jsx("img",{onClick:g,src:O,className:"excluir"}),e.jsxs("div",{className:"btt",children:[e.jsx("input",{checked:r.privado==1,"data-anjoovi-user":r.usuario,onChange:N,type:"checkbox",tabIndex:3}),e.jsx("div",{className:"espaco",tabIndex:0}),e.jsxs("div",{className:"content",children:[e.jsx("div",{className:"bttb",tabIndex:1}),e.jsx("div",{className:"aviso",tabIndex:2})]})]})]})})]})});function $(){const[t,n]=s.useState(!1),[x,u]=s.useState(!1),[p,h]=s.useState(!1),{stateReducer:i,setStateReducer:r,namePrivate:f}=L(),[y,j]=s.useState({posts:[],numRegistros:0,isReady:null,bvLink:!1,biLink:!1,nd:0,pa:null,pesquisa:null}),{server:N,setSelected:g}=T(),c=X(),E=s.useRef(),S=s.useRef(),C=s.useRef(),a={exclusion:s.useRef(null),usuarioExclusion:s.useRef(null),inputPrivate:s.useRef(null),pai:s.useRef(null)},b=l=>{l?!a.pai.current.classList.contains("loading")&&a.pai.current.classList.add("loading"):a.pai.current.classList.contains("loading")&&a.pai.current.classList.remove("loading")},I=({usuario:l,server:o,auth:m,recriar:d})=>{n(!0),a.usuarioExclusion.current=l,E.current=o,S.current=m,C.current=d},w=l=>{l.preventDefault();const o=E.current,m=S.current,d=a.exclusion.current.value,k=a.usuarioExclusion.current,v=C.current;b(!0),m.post(o+"/admin/users",{type:"option",tipo:"delete",name:k,senha:d}).then(R=>{b(!1),R.data.result=="true"?(n(!1),v(R.data),u(!1)):R.data.result=="false"&&u(!0)})},U=s.useCallback(l=>{l.preventDefault();const o=f.current,m=a.inputPrivate.current.value;b(!0),c.post(N+"/admin/users",{type:"option",tipo:"private",name:o,senha:m}).then(d=>{b(!1),d.data.result=="true"?(a.inputPrivate.current.value="",i.element.click(),p&&h(!1),f.current=void 0,j(k=>({...k,posts:k.posts.map(v=>v.usuario==o?{...v,privado:i.checked?1:0}:v)})),r({type:"reset"})):d.data.result=="false"&&h(!0),r({type:"reset"})})},[p,i]),D=()=>{r({type:"menu"},!1)},M=()=>{n(!1)};return s.useEffect(()=>{g("users")},[]),e.jsx("div",{className:"us cld",ref:a.pai,children:e.jsxs("div",{id:"pg",children:[e.jsxs("div",{id:"dt",className:"fechado",children:[e.jsx("div",{id:"msg1",children:"Listar usuários"}),e.jsxs("div",{id:"top",children:[e.jsx("div",{id:"div_info",children:"Informações"}),e.jsx(z,{infos:y,setInfos:j,openExclusion:I,NewTable:_,NewHeader:H})]})]}),e.jsx("div",{className:"menu-a",style:{display:t||i.menu?"block":"none"}}),e.jsxs("div",{style:{display:t?"block":"none"},id:"exclusiond",children:[e.jsx("div",{className:"x",onClick:M,children:"X"}),e.jsxs("form",{onSubmit:w,children:[e.jsx("div",{className:"error",style:{display:x?"block":"none"},children:"Senha de exclusão incorreta."}),e.jsx("input",{ref:a.exclusion,type:"password",placeholder:"Digite a senha de exclusão"}),e.jsx("button",{type:"submit",children:"Excluir"})]})]}),e.jsx("div",{className:"menu-a l-l"}),e.jsxs("div",{id:"menu-private",style:{display:i.menu?"flex":"none"},children:[e.jsx(A,{className:"x",onClick:D}),e.jsxs("form",{onSubmit:U,id:"center-menu-private",children:[e.jsx("div",{className:"error",style:{display:p?"block":"none"},children:"Senha de exclusão incorreta."}),e.jsxs("div",{id:"group-menu-private",children:[e.jsx("input",{ref:a.inputPrivate,placeholder:"Insira a senha de exclusão"}),e.jsx("button",{type:"submit",children:i.checked?"privar":"desprivar"})]})]})]}),e.jsx("div",{id:"loading-div",children:e.jsx("i",{id:"loading",className:"ball loading-ball bi-arrow-clockwise",style:{fontSize:"70px"}})})]})})}function B(){return e.jsx(G,{children:e.jsx($,{})})}const K=s.memo(B);export{K as default};
