import{r as s,j as e,L as q,e as O,u as T,a as X,d as z}from"./index-D4x5zLeu.js";const P=s.createContext(void 0),A=(t,n)=>{switch(n.type){case"menu":return{...t,menu:n.value};case"all":return{menu:n.menu,checked:n.checked,element:n.element};case"reset":return{menu:!1,checked:!1,element:!1}}},F=({children:t})=>{const[n,x]=s.useReducer(A,{menu:!1,checked:!1,element:!1,usuarioCallback:!1}),u=s.useRef();return e.jsx(P.Provider,{value:{namePrivate:u,stateReducer:n,setStateReducer:x},children:t})},L=()=>s.useContext(P),G=s.memo(()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"num",children:"N°"}),e.jsx("div",{className:"usuario",children:"USUÁRIO"}),e.jsx("div",{className:"opcoes",children:"OPÇÕES"})]})),H=s.memo(t=>{const{stateReducer:n,setStateReducer:x,namePrivate:u}=L(),h=t.globals.server,c=t.auth,r=t.post,f=t.n,y=t.openExclusion,j=t.recriar,N=i=>{n.usuarioCallback||(i.preventDefault(),u.current=i.target.dataset.anjooviUser),x({type:"all",menu:!0,checked:i.target.checked,element:i.target})},R=()=>{y({usuario:r.usuario,server:h,auth:c,recriar:j})};return e.jsxs("div",{className:"linha",children:[e.jsx("div",{className:"num",children:f}),e.jsx(q,{className:"usuario txt-1",onClick:i=>{i.preventDefault(),window.open("/@"+r.usuario)},to:"/@"+r.usuario,children:r.usuario}),e.jsx("div",{className:"opcoes",children:e.jsxs("div",{className:"opcoesb",children:[e.jsx("img",{onClick:R,src:O,className:"excluir"}),e.jsxs("div",{className:"btt",children:[e.jsx("input",{checked:r.privado=="true","data-anjoovi-user":r.usuario,onChange:N,type:"checkbox",tabIndex:3}),e.jsx("div",{className:"espaco",tabIndex:0}),e.jsxs("div",{className:"content",children:[e.jsx("div",{className:"bttb",tabIndex:1}),e.jsx("div",{className:"aviso",tabIndex:2})]})]})]})})]})});function _(){const[t,n]=s.useState(!1),[x,u]=s.useState(!1),[p,h]=s.useState(!1),{stateReducer:c,setStateReducer:r,namePrivate:f}=L(),[y,j]=s.useState({posts:[],numRegistros:0,isReady:null,bvLink:!1,biLink:!1,nd:0,pa:null,pesquisa:null}),{server:N,setSelected:R}=T(),i=X(),E=s.useRef(),S=s.useRef(),C=s.useRef(),a={exclusion:s.useRef(null),usuarioExclusion:s.useRef(null),inputPrivate:s.useRef(null),pai:s.useRef(null)},b=l=>{l?!a.pai.current.classList.contains("loading")&&a.pai.current.classList.add("loading"):a.pai.current.classList.contains("loading")&&a.pai.current.classList.remove("loading")},I=({usuario:l,server:o,auth:m,recriar:d})=>{n(!0),a.usuarioExclusion.current=l,E.current=o,S.current=m,C.current=d},w=l=>{l.preventDefault();const o=E.current,m=S.current,d=a.exclusion.current.value,k=a.usuarioExclusion.current,v=C.current;b(!0),m.post(o+"/admin/users",{type:"option",tipo:"delete",name:k,senha:d}).then(g=>{b(!1),g.data.result=="true"?(n(!1),v(g.data),u(!1)):g.data.result=="false"&&u(!0)})},U=s.useCallback(l=>{l.preventDefault();const o=f.current,m=a.inputPrivate.current.value;b(!0),i.post(N+"/admin/users",{type:"option",tipo:"private",name:o,senha:m}).then(d=>{b(!1),d.data.result=="true"?(a.inputPrivate.current.value="",c.element.click(),p&&h(!1),f.current=void 0,j(k=>({...k,posts:k.posts.map(v=>v.usuario==o?{...v,privado:c.checked?"true":"false"}:v)})),r({type:"reset"})):d.data.result=="false"&&h(!0),r({type:"reset"})})},[p,c]),D=()=>{r({type:"menu"},!1)},M=()=>{n(!1)};return s.useEffect(()=>{R("users")},[]),e.jsx("div",{className:"us cld",ref:a.pai,children:e.jsxs("div",{id:"pg",children:[e.jsxs("div",{id:"dt",className:"fechado",children:[e.jsx("div",{id:"msg1",children:"Listar usuários"}),e.jsxs("div",{id:"top",children:[e.jsx("div",{id:"div_info",children:"Informações"}),e.jsx(z,{infos:y,setInfos:j,openExclusion:I,NewTable:H,NewHeader:G})]})]}),e.jsx("div",{className:"menu-a",style:{display:t||c.menu?"block":"none"}}),e.jsxs("div",{style:{display:t?"block":"none"},id:"exclusiond",children:[e.jsx("div",{className:"x",onClick:M,children:"X"}),e.jsxs("form",{onSubmit:w,children:[e.jsx("div",{className:"error",style:{display:x?"block":"none"},children:"Senha de exclusão incorreta."}),e.jsx("input",{ref:a.exclusion,type:"password",placeholder:"Digite a senha de exclusão"}),e.jsx("button",{type:"submit",children:"Excluir"})]})]}),e.jsx("div",{className:"menu-a l-l"}),e.jsxs("div",{id:"menu-private",style:{display:c.menu?"flex":"none"},children:[e.jsx("div",{className:"x",onClick:D,children:"X"}),e.jsxs("form",{onSubmit:U,id:"center-menu-private",children:[e.jsx("div",{className:"error",style:{display:p?"block":"none"},children:"Senha de exclusão incorreta."}),e.jsxs("div",{id:"group-menu-private",children:[e.jsx("input",{ref:a.inputPrivate,placeholder:"Insira a senha de exclusão"}),e.jsx("button",{type:"submit",children:c.checked?"privar":"desprivar"})]})]})]}),e.jsx("div",{id:"loading",children:e.jsx("i",{className:"ball loading-ball bi-arrow-clockwise",style:{fontSize:"70px"}})})]})})}function $(){return e.jsx(F,{children:e.jsx(_,{})})}const J=s.memo($);export{J as default};
