import{r as s,j as e,d as q,e as O,u as T,a as X,L as z,X as A}from"./index-DoEcavCg.js";const P=s.createContext(void 0),F=(t,a)=>{switch(a.type){case"menu":return{...t,menu:a.value};case"all":return{menu:a.menu,checked:a.checked,element:a.element};case"reset":return{menu:!1,checked:!1,element:!1}}},G=({children:t})=>{const[a,m]=s.useReducer(F,{menu:!1,checked:!1,element:!1,usuarioCallback:!1}),x=s.useRef();return e.jsx(P.Provider,{value:{namePrivate:x,stateReducer:a,setStateReducer:m},children:t})},L=()=>s.useContext(P),H=s.memo(()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"num",children:"N°"}),e.jsx("div",{className:"usuario",children:"USUÁRIO"}),e.jsx("div",{className:"opcoes",children:"OPÇÕES"})]})),_=s.memo(t=>{const{stateReducer:a,setStateReducer:m,namePrivate:x}=L(),f=t.globals.server,i=t.auth,r=t.post,j=t.n,N=t.openExclusion,b=t.recriar,k=c=>{a.usuarioCallback||(c.preventDefault(),x.current=c.target.dataset.anjooviUser),m({type:"all",menu:!0,checked:c.target.checked,element:c.target})},R=()=>{N({usuario:r.usuario,server:f,auth:i,recriar:b})};return console.log(r.cargo),e.jsxs("div",{className:"linha",children:[e.jsx("div",{className:"num",children:j}),e.jsx(q,{className:"usuario txt-1",onClick:c=>{c.preventDefault(),window.open("/@"+r.usuario)},to:"/@"+r.usuario,children:r.usuario}),e.jsx("div",{className:"opcoes",children:e.jsxs("div",{className:"opcoesb",children:[e.jsx("img",{onClick:R,src:O,className:"excluir"}),e.jsxs("div",{className:"btt",children:[e.jsx("input",{checked:(Number(r.cargo)&1)==0,"data-anjoovi-user":r.usuario,onChange:k,type:"checkbox",tabIndex:3}),e.jsx("div",{className:"espaco",tabIndex:0}),e.jsxs("div",{className:"content",children:[e.jsx("div",{className:"bttb",tabIndex:1}),e.jsx("div",{className:"aviso",tabIndex:2})]})]})]})})]})});function $(){const[t,a]=s.useState(!1),[m,x]=s.useState(!1),[h,f]=s.useState(!1),{stateReducer:i,setStateReducer:r,namePrivate:j}=L(),[N,b]=s.useState({posts:[],numRegistros:0,isReady:null,bvLink:!1,biLink:!1,nd:0,pa:null,pesquisa:null}),{server:k,setSelected:R}=T(),c=X(),E=s.useRef(),S=s.useRef(),C=s.useRef(),n={exclusion:s.useRef(null),usuarioExclusion:s.useRef(null),inputPrivate:s.useRef(null),pai:s.useRef(null)},g=l=>{l?!n.pai.current.classList.contains("loading")&&n.pai.current.classList.add("loading"):n.pai.current.classList.contains("loading")&&n.pai.current.classList.remove("loading")},I=({usuario:l,server:u,auth:v,recriar:o})=>{a(!0),n.usuarioExclusion.current=l,E.current=u,S.current=v,C.current=o},w=l=>{l.preventDefault();const u=E.current,v=S.current,o=n.exclusion.current.value,y=n.usuarioExclusion.current,p=C.current;g(!0),v.post(u+"/admin/users",{type:"option",tipo:"delete",name:y,senha:o}).then(d=>{g(!1),d.data.result=="true"?(a(!1),p(d.data),x(!1)):d.data.result=="false"&&x(!0)})},U=s.useCallback(l=>{l.preventDefault();const u=j.current,v=n.inputPrivate.current.value;g(!0),c.post(k+"/admin/users",{type:"option",tipo:"private",name:u,senha:v}).then(o=>{g(!1),o.data.result=="true"?(n.inputPrivate.current.value="",i.element.click(),h&&f(!1),j.current=void 0,b(y=>({...y,posts:y.posts.map(p=>p.usuario==u?{...p,cargo:o.data.posts.filter(d=>d.usuario==u).map(d=>d.cargo)}:p)})),r({type:"reset"})):o.data.result=="false"&&f(!0),r({type:"reset"})})},[h,i]),D=()=>{r({type:"menu"},!1)},M=()=>{a(!1)};return s.useEffect(()=>{R("users")},[]),e.jsx("div",{className:"us cld",ref:n.pai,children:e.jsxs("div",{id:"pg",children:[e.jsxs("div",{id:"dt",className:"fechado",children:[e.jsx("div",{id:"msg1",children:"Listar usuários"}),e.jsxs("div",{id:"top",children:[e.jsx("div",{id:"div_info",children:"Informações"}),e.jsx(z,{infos:N,setInfos:b,openExclusion:I,NewTable:_,NewHeader:H})]})]}),e.jsx("div",{className:"menu-a",style:{display:t||i.menu?"block":"none"}}),e.jsxs("div",{style:{display:t?"block":"none"},id:"exclusiond",children:[e.jsx("div",{className:"x",onClick:M,children:"X"}),e.jsxs("form",{onSubmit:w,children:[e.jsx("div",{className:"error",style:{display:m?"block":"none"},children:"Senha de exclusão incorreta."}),e.jsx("input",{ref:n.exclusion,type:"password",placeholder:"Digite a senha de exclusão"}),e.jsx("button",{type:"submit",children:"Excluir"})]})]}),e.jsx("div",{className:"menu-a l-l"}),e.jsxs("div",{id:"menu-private",style:{display:i.menu?"flex":"none"},children:[e.jsx(A,{className:"x",onClick:D}),e.jsxs("form",{onSubmit:U,id:"center-menu-private",children:[e.jsx("div",{className:"error",style:{display:h?"block":"none"},children:"Senha de exclusão incorreta."}),e.jsxs("div",{id:"group-menu-private",children:[e.jsx("input",{ref:n.inputPrivate,placeholder:"Insira a senha de exclusão"}),e.jsx("button",{type:"submit",children:i.checked?"privar":"desprivar"})]})]})]}),e.jsx("div",{id:"loading-div",children:e.jsx("i",{id:"loading",className:"ball loading-ball bi-arrow-clockwise",style:{fontSize:"70px"}})})]})})}function B(){return e.jsx(G,{children:e.jsx($,{})})}const K=s.memo(B);export{K as default};
