import{r as n,j as e,u as E,f as _,s as L,X as F,d as J,a as M,b as B}from"./index-D62E453h.js";function G({option:u,globals:h,auth:o}){const r={input:n.useRef(null)},i=a=>{a.preventDefault(),o.post(h.server+"/admin/views",{type:"option",value:r.input.current?r.input.current.checked?"true":"false":!1}).then(t=>{t.data.result=="true"&&(r.input.current.checked=!r.input.current.checked)})};return n.useEffect(()=>{o.post(h.server+"/admin/views",{type:"info"}).then(a=>{a.data.result=="true"&&a.data.response=="true"&&r.input.current&&(r.input.current.checked=!0)})},[]),u=="views"?e.jsx("div",{className:"views-div",children:e.jsx("div",{id:"musica-d",children:e.jsxs("div",{className:"btn-d",children:[e.jsx("input",{ref:r.input,className:"i",type:"checkbox",onChange:i}),e.jsx("div",{className:"select"})]})})}):null}const P=n.createContext(void 0),z=({children:u,auth:h,server:o})=>{const[r,i]=n.useState(),a=E(),t=n.useCallback(()=>{h.post(o+"/admin/settings",{type:"info"}).then(j=>{j.error?a.redirectError.current(j.error):i(j.data.config)})},[r]);return n.useEffect(()=>{t()},[]),e.jsx(P.Provider,{value:{config:r,setConfig:i},children:u})},U=()=>{const u=n.useContext(P);if(!u)throw new Error("settingsContext deve ser usado dentro de setingsContext.Provider");return u};function H({option:u,globals:h,auth:o}){const{config:r,setConfig:i}=U(),a=n.useRef(null),t=h.server,j=()=>{const l=new FormData;l.append("type","option"),l.append("logo",a.current.files[0]),o.post(t+"/admin/settings?type=logo",l,{arquivo:!0}).then(k=>{k.error?h.redirectError.current(k.error):i(N=>({...N,logo:k.data.lsrc}))})},R=()=>{a.current.click()},p=()=>{o.post(t+"/admin/settings?type=logo&operation=d",{type:"option"}).then(l=>{l.error?h.redirectError.current(l.error):i(k=>({...k,logo:null}))})};return u=="logo"?e.jsxs("div",{className:"logo-div",children:[r?e.jsx(_,{logo:r.logo||null,usuario:h.login.usuario,width:"20vh"}):null,e.jsx("div",{id:"alterar",onClick:R,children:"Alterar"}),e.jsx("div",{id:"excluir",onClick:p,children:"Excluir"}),e.jsx("input",{style:{display:"none"},ref:a,onChange:j,type:"file",accept:"image/jpeg, image/jpg"})]}):e.jsx(e.Fragment,{})}function T({option:u,globals:h,auth:o}){const{config:r,setConfig:i}=U(),a=h.server,t=n.useRef(null),j=()=>{var l=new FormData;l.append("type","option"),l.append("banner",t.current.files[0]),o.post(a+"/admin/settings?type=banner",l,{arquivo:!0}).then(k=>{k.error?h.redirectError.current(k.error):i(N=>({...N,banner:k.data.banner}))})},R=()=>{t.current.click()},p=()=>{o.post(a+"/admin/settings?type=banner&operation=d",{type:"option"}).then(l=>{l.error?h.redirectError.current(l.error):i(k=>({...k,banner:null}))})};return u=="banner"?e.jsxs("div",{className:"banner-div",children:[e.jsx("img",{className:"banner-img",src:r&&r.banner?a+"/images/"+encodeURIComponent(r.banner):L}),e.jsx("div",{id:"alterar",onClick:R,children:"Alterar"}),e.jsx("div",{id:"excluir",onClick:p,children:"Excluir"}),e.jsx("input",{style:{display:"none"},ref:t,onChange:j,type:"file",accept:"image/jpeg, image/jpg"})]}):e.jsx(e.Fragment,{})}function X({option:u,globals:h,auth:o,location:r}){const{server:i,navigate:a}=h,[t,j]=n.useState(!1),[R,p]=n.useState([]),[l,k]=n.useState({geral:{src:null},materia:{src:null},imagem:{src:null},musica:{src:null},texto:{src:null},video:{src:null},playlist:{src:null}}),[N,C]=n.useState(!1),f=n.useRef(null),c={input:n.useRef(null),geral:n.useRef(null),materia:n.useRef(null),imagem:n.useRef(null),musica:n.useRef(null),texto:n.useRef(null),video:n.useRef(null),playlist:n.useRef(null)},d=s=>{var x=s.target.parentNode.parentNode.children[2];if(!s.target.checked){var y=s.target.name;o.post(i+"/admin/destaque",{type:"disable",tipo:y}).then(S=>{k(w=>({...w,[y]:{src:null}}))})}x.classList.toggle("show")},m=s=>{const x=new URLSearchParams(r.search);x.set("search",c.input.current?c.input.current.value:""),x.set("tipo",f.current),a(r.pathname+"?"+x.toString()),s.preventDefault(),v()},g=s=>{const x=f.current;o.post(i+"/admin/destaque",{type:"option",tipo:x,id:s}).then(y=>{y.data.result=="true"&&k(S=>({...S,[x]:y.data.destaque}))}),b()},v=()=>{var s=c.input.current?c.input.current.value:"";o.post(h.server+"/admin/destaque?search="+s,{type:"search",tipo:f.current}).then(x=>{x.data.result=="true"&&p(x.data.noticias)})},I=()=>{o.post(i+"/admin/destaque",{type:"info"}).then(s=>{if(s.data.result=="true"){const D=s.data.destaques;var x=["geral","materia","imagem","musica","texto","video","playlist"];for(var y of x)if(D[y]&&D[y].src){var S=c[y].current;S.checked=!0;var w=S.parentNode.parentNode.children[2];w.classList.contains("show")?w.classList.remove("show"):w.classList.add("show")}s.data.response=="true"&&k(s.data.destaques)}})},A=s=>{const x=new URLSearchParams(r.search);x.set("tipo",s),a(r.pathname+"?"+x.toString()),f.current=s,j(!0),c.input.current.value="",v(),C(s)},b=()=>{const s=new URLSearchParams(r.search);s.delete("search"),s.delete("tipo"),j(!1),f.current=null,a(r.pathname+"?"+s.toString()),c.input.current.value="",C(!1)};n.useEffect(()=>{const s=new URLSearchParams(r.search);s.has("tipo")&&s.has("search")&&(f.current=s.get("tipo"),c.input.current&&(c.input.current.value=s.get("search")||""),j(!0),v()),I()},[]),n.useEffect(()=>{u!="destaque"&&j(!1)},[u]);const O=[{title:"Geral:",name:"geral"},{title:"Matéria:",name:"materia"},{title:"Imagem:",name:"imagem"},{title:"Música:",name:"musica"},{title:"Texto:",name:"texto"},{title:"Vídeo:",name:"video"},{title:"Playlist:",name:"playlist"}],q={p:"noticia",i:"imagem",t:"texto",v:"video",pl:"playlist"},V=s=>{try{return JSON.parse(s)}catch{return!1}};return e.jsxs("div",{style:{display:u=="destaque"?"block":"none"},className:"destaques-div",children:[e.jsx("div",{id:"avs",children:"Obs: caso uma divisão não tenha um destaque selecionado, aparecerá o destaque geral."}),e.jsx("div",{id:"list",children:O.map((s,x)=>{const y=l[s.name]&&l[s.name].src?V(l[s.name].src):!1;return e.jsxs("div",{className:"list-item",children:[e.jsx("label",{children:s.title}),e.jsxs("div",{className:"btn-d",children:[e.jsx("input",{ref:c[s.name],className:"i",name:s.name,type:"checkbox",onChange:d}),e.jsx("div",{className:"select"})]}),e.jsxs("div",{className:"content",children:[e.jsx("div",{id:"geral-d",children:e.jsx("div",{className:"imagem-view",children:!y||y[1]=="i"?e.jsx("img",{className:"imagem-content",src:l[s.name]&&l[s.name].src?i+"/images/"+encodeURIComponent(l[s.name].src):L}):y&&y[1]=="v"?e.jsx("video",{className:"imagem-content",src:i+"/videos/"+encodeURIComponent(y[0])}):e.jsx("div",{children:y[0]})})}),e.jsx("div",{className:"select"+(N==s.name?" open":""),onClick:()=>{A(s.name)},children:"selecionar"})]})]},x)})}),e.jsxs("div",{style:{display:t?"block":"none"},id:"pesquisa",children:[e.jsxs("form",{onSubmit:m,id:"div-pesqusia",children:[e.jsx("div",{children:"titulo:"}),e.jsx("input",{ref:c.input,onInput:m})]}),e.jsx(F,{onClick:b,className:"x"}),e.jsx("div",{id:"conteudo",children:R.map((s,x)=>e.jsxs("div",{onClick:()=>{g(s.id)},className:"result",children:[e.jsx("p",{className:"title-post txt",children:s.titulo}),e.jsx(J,{onClick:y=>{y.preventDefault(),window.open("/"+q[s.tipo]+"/"+s.id_post,"__blank")},to:"/"+q[s.tipo]+"/"+s.id_post,children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"external",viewBox:"0 0 16 16",children:[e.jsx("path",{"fill-rule":"evenodd",d:"M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"}),e.jsx("path",{"fill-rule":"evenodd",d:"M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"})]})})]},x))})]})]})}function K({option:u,globals:h,auth:o}){const{server:r}=h,[i,a]=n.useState({previousDescription:"",currentDescription:""}),t={description:n.useRef(null)},j=l=>{a(k=>({...k,currentDescription:l.target.value}))},R=()=>{o.post(r+"/admin/description",{type:"info"}).then(l=>{a({previousDescription:"",currentDescription:""}),t.description.current.value=l.data.description})};n.useEffect(()=>{R()},[]);const p=()=>{const l=t.description.current.value;i.previousDescription!=i.currentDescription&&i.currentDescription!=""&&(a({previousDescription:l,currentDescription:l}),o.post(r+"/admin/description",{type:"update",description:l}))};return e.jsxs("div",{style:{display:u=="descricao"?"block":"none"},className:"description-div",children:[e.jsx("textarea",{id:"text",ref:t.description,onChange:j}),i.previousDescription!=i.currentDescription&&i.currentDescription!=""?e.jsx("div",{id:"save",onClick:p,children:"Salvar"}):e.jsx("div",{id:"save",className:"loading",onClick:p,children:"Salvar"})]})}function Q({option:u,globals:h,auth:o}){const{server:r}=h,[i,a]=n.useState([{linkRef:n.createRef(),titleRef:n.createRef()}]),t=n.useRef([{title:"",link:""}]),[j,R]=n.useState(!1),p=n.useRef(""),l=()=>{o.post(r+"/admin/card",{type:"info"}).then(f=>{const c=JSON.parse(f.data.card);a(()=>(t.current=[],Array.from({length:c.links.length+1},(d,m)=>(t.current.push(m<c.links.length?{title:c.titles[c.links[m]],link:c.links[m]}:{title:"",link:""}),{linkRef:n.createRef(),titleRef:n.createRef()})))),p.current=c.links.map(d=>c.titles[d]+d).join("")})};n.useEffect(()=>{l()},[]);const k=()=>{const f=t.current.map(({title:m,link:g})=>m+g).join(""),c={},d=t.current.map(m=>{const{title:g,link:v}=m;return g!=""&&C(v)&&(c[v]=g),v}).filter(m=>m!="");p.current!=f&&(p.current!=""||f!="")&&(R(!1),p.current=f,o.post(r+"/admin/card",{type:"update",titles:JSON.stringify(c),links:JSON.stringify(d)}))},N=()=>{var f=!0;const c={};for(var d=0;d<t.current.length;d++){const{title:m,link:g}=t.current[d];if(g in c){f=!1;break}else if(c[g]=!0,d<t.current.length-1&&(m==""||!C(g))){f=!1;break}}return f},C=f=>{try{const c=new URL(f);return c.protocol="https:"}catch{return!1}};return n.useEffect(()=>{var f=!0;const c={};for(var d=0;d<t.current.length;d++){const{title:m,link:g}=t.current[d];if(g in c){f=!1;break}else if(c[g]=!0,d<t.current.length-1&&(m==""||!C(g))||d==t.current.length-1&&(m==""&&C(g)||m!=""&&!C(g))){f=!1;break}}if(f){const m=t.current.map(({title:g,link:v})=>g+v).join("");R(p.current!=m)}else R(!1)},[i]),e.jsxs("div",{style:{display:u=="card"?"block":"none"},className:"card-div",children:[i.map(({linkRef:f,titleRef:c},d)=>e.jsxs("div",{children:[e.jsxs("label",{className:"card-input-label",children:["Link ",d+1]}),e.jsx("input",{value:t.current[d].title,ref:c,className:"card-input",onInput:m=>{const g=m.target.value;if(t.current[d].title=g,d>0&&!N()&&t.current[t.current.length-1].title+t.current[t.current.length-1].link==""){const v=[...i];t.current.pop(),v.pop(),a(v)}else i.length<15&&N()&&t.current[t.current.length-1].title!=""&&C(t.current[t.current.length-1].link)?(t.current.push({title:"",link:""}),a(v=>[...v.concat([{linkRef:n.createRef(),titleRef:n.createRef()}])])):a(v=>[...v])}}),e.jsx("input",{value:t.current[d].link,ref:f,className:"card-input",onInput:m=>{const g=m.target.value;if(t.current[d].link=g,d>0&&!N()&&t.current[t.current.length-1].title+t.current[t.current.length-1].link==""){const v=[...i];t.current.pop(),v.pop(),a(v)}else i.length<15&&N()&&t.current[t.current.length-1].title!=""&&C(t.current[t.current.length-1].link)?(t.current.push({title:"",link:""}),a(v=>[...v.concat([{linkRef:n.createRef(),titleRef:n.createRef()}])])):a(v=>[...v])}})]})),j?e.jsx("div",{id:"save",onClick:k,children:"Salvar"}):e.jsx("div",{id:"save",className:"loading",children:"Salvar"})]})}function Y(){const u=E(),{navigate:h}=u,o=M(),[r,i]=n.useState(null),a=B(),[t,j]=n.useState(!1);n.useEffect(()=>{const p=new URLSearchParams(a.search);p.has("option")?i(p.get("option")):(p.set("option","logo"),i("logo")),u.setSelected("settings")},[]),n.useEffect(()=>{if(r){const p=new URLSearchParams(a.search);(p.has("option")?p.get("option"):"logo")!=r&&(j("true"),p.set("option",r),h(a.pathname+(r=="logo"?"":"?"+p.toString())))}},[r]),n.useEffect(()=>{if(t&&t=="false"){const p=new URLSearchParams(a.search);i(p.get("option")||"logo")}else t&&t=="true"&&j("false")},[a.search]);const R=n.useRef({logo:"selected1",banner:"selected2",destaque:"selected3",views:"selected4",descricao:"selected5",card:"selected6"});return e.jsx("div",{className:"config",children:e.jsx("div",{id:"pg",children:e.jsxs("div",{className:"margin",children:[e.jsxs("div",{id:"tipod",children:[e.jsx("div",{id:"tipobd",style:{display:r?"block":"none"},className:R.current[r]||""}),e.jsxs("div",{id:"tipot",children:[e.jsx("div",{onClick:()=>i("logo"),className:"tipo t1",children:"Logo"}),e.jsx("div",{onClick:()=>{i("banner")},className:"tipo t2",children:"Banner"}),e.jsx("div",{onClick:()=>i("destaque"),className:"tipo t3",children:"Destaque"}),e.jsx("div",{onClick:()=>i("views"),className:"tipo t4",children:"Views"}),e.jsx("div",{onClick:()=>i("descricao"),className:"tipo t5",children:"Descrição"}),e.jsx("div",{onClick:()=>i("card"),className:"tipo t6",children:"Card"})]})]}),e.jsx("div",{children:e.jsxs(z,{auth:o,server:u.server,children:[e.jsx(H,{option:r,globals:u,auth:o}),e.jsx(T,{option:r,globals:u,auth:o}),e.jsx(X,{option:r,globals:u,auth:o,location:a}),e.jsx(G,{option:r,globals:u,auth:o}),e.jsx(K,{option:r,globals:u,auth:o}),e.jsx(Q,{option:r,globals:u,auth:o})]})})]})})})}export{Y as default};
